\chapter{`What not' detectors help the brain see in depth}
\ifpdf
    \graphicspath{{chapter1/chapter1-figs/PNG/}{chapter1/chapter1-figs/PDF/}{chapter1/chapter1-figs/}}
\else
    \graphicspath{{chapter1/chapter1-figs/EPS/}{chapter1/chapter1-figs/}}
\fi

\newcommand{\runningTitle}{`What not' detectors}
\markboth{\MakeUppercase{\thechapter. \runningTitle }}{\thechapter. \runningTitle}

% To do:
% [ ] check equations 
% [ ] replace citations
% [ ] include figures
% [ ]Â replace reference to main figures
% [ ] replace references to supplementary figures, etc...
% [ ] remove unnecessary italic and bold formatting 
% [ ] double check equations

This chapter reproduces the work associated with the following published manuscript: 

Goncalves NG \& Welchman AE. ``What not'' detectors help the brain see in depth. \textit{Current Biology}, 27, 1403--1412. 2017.

\section{Introduction}

Geometry dictates that a three-dimensional (3D) object viewed from the two eyes will (i) project features to different positions on the two retinae, and (ii) render certain portions visible to only one eye due to occlusion at the object's contours \cite{Wheatstone:1838xf}. Computational \cite{Julesz:1971uq,Marr:1976dq,Scharstein:2002by} and neurophysiological \cite{Cumming:2001jy} investigations over the past fifty years have focused almost exclusively on positional differences (i), as partial-occlusions (ii) are regarded as excessively under-constrained. Under this intuitive approach, by registering the positional difference of the same feature in the two eyes ({\it binocular disparity}), the brain could triangulate to infer the object's 3D structure. Thus, while the genesis of binocular information lies in image \emph {differences}, current understanding at the computational- and neural- levels stresses the centrality of identifying \emph {similarities} between the eyes to extract depth.

Within this framework, the fundamental challenge of stereopsis is described as solving the `correspondence problem' \cite{Julesz:1971uq,Marr:1976dq,Scharstein:2002by} whereby images of the same real-world feature are matched between the eyes. This is problematic because of `false matches' --- i.e., correspondences that conflate signals originating from different locations in 3D space. The principal means of identifying corresponding features is to consider a range of potential disparities and select the offset that maximises similarity between the eyes. This is captured computationally by the peak local cross-correlation. How might this be achieved by the brain? Current understanding is provided by the Disparity Energy Model of V1 neurons \cite{Ohzawa:1990cq, Fleet:1996tq, Qian:1997bu} in which binocular simple cells with disparity preference, $\delta_{pref}$, are combined by a complex cell preferring the same disparity (Fig. \ref{fig:c1f1}A). Using a population of cells with different $\delta_{pref}$, the brain could select the most active neuron to estimate depth.

However, from the perspective of finding correct matches, it is puzzling that many V1 neurons sense different things in the two eyes \cite{DeAngelis:1991mb, Prince:2002uq, Tsao:2003pi}. In particular, while binocular neurons can have receptive fields offset in location ({\it position disparity}), they often have different receptive field profiles in the two eyes ({\it phase disparity}) (Fig. \ref{fig:c1f1}B). The surprising implication is that phase neurons respond maximally to images that do not relate to a single physical feature in the world \cite{Read:2007nx}. What are such responses for? 

Here we suggest that V1 neurons should be understood as using a coding strategy designed to reduce uncertainty about the depth of the viewed scene. This involves the brain using both similar and dissimilar image features to infer depth. We show that long-standing puzzles in binocular vision at the physiological- and perceptual- levels can be understood by mixing feature detection with \emph {proscription}. Specifically, by sensing \emph {dissimilar} features the brain gains valuable information that drives suppression of unlikely interpretations of the scene. Our approach explains challenges to the standard treatment of disparity (i), and importantly, also accounts for (ii) partial occlusions that have long evaded explanation because of their incompatibility with registering depth based on peak cross-correlation. 

\section{Results}

We start by considering known properties of binocular neurons from a statistical perspective \cite{Shannon1948}, to demonstrate that properties that have long seemed puzzling in fact suggest optimal coding. Position-disparity units (Fig. \ref{fig:c1f1}B, purple) are easily understood from the traditional perspective: a viewed object will project its features to different locations on the two retinae, so a binocular unit could simply offset the receptive field location for the two eyes. Phase-disparity units (Fig. \ref{fig:c1f1}B, orange), by contrast, have a different receptive field structure in the two eyes. This means they respond best to stimulation that could not originate from a single physical feature in the world. We contrasted phase- and position- encoding by computing Shannon information \cite{Shannon1948} as a function of stimulus disparity (see Methods), where simple units were modeled as linear filters followed by a rectified squaring non-linearity \cite{Ohzawa:1990cq}. Because of the larger change in firing of the phase units, they provide more information about the viewed stimulus than position units (Fig. \ref{fig:c1f1}C). Importantly, the peak information provided by a phase unit is not at the traditionally-labelled $\delta_{pref}$ (i.e., peak firing rate), meaning that the Disparity Energy Model's architecture (Fig. \ref{fig:c1f1}A) of collating signals from units with the same $\delta_{pref}$ is likely to be suboptimal. We then examined encoding in a small population of simple units with \emph {position}, \emph {phase} or \emph {hybrid} receptive fields. We found that \emph {hybrid} encoding (i.e. combined phase and position shifts: {Fig. \ref{fig:c1f1}B) conveys more information than either pure phase or position encoding (Fig. \ref{fig:c1f1}D). This suggests that the abundance of hybrid selectivity in V1 neurons \cite{DeAngelis:1991mb, Prince:2002uq, Tsao:2003pi} may relate to optimal encoding. 

\begin{figure}[!h]
  \centering
  \includegraphics{chapter1/chapter1-figs/Fig1.pdf}
  \caption[Disparity encoding and Shannon information.]{Disparity encoding and Shannon information. ({\bf A}) The canonical Disparity Energy Model. Simple and complex units have the same preferred disparity, $\delta_{pref}$. ({\bf B}) Simple cells encode disparity using differences in receptive field: position ({\it position} disparity), structure ({\it phase} disparity), or both ({\it hybrid}). ({\bf C}) Mean response of model simple units to 100,000 stereograms (top) and the corresponding Shannon information (bottom). Pink {\it vs}. yellow series contrast pure position vs. phase ($\pi/2$) encoding, both with $\delta_{pref}$=4. Considering units between pure position and pure phase encoding produces a graceful morphing in the shapes of the curves. ({\bf D}) Shannon information for a small population ($N=5$) of simple units with position, phase or hybrid sensors. (Computing Shannon information for larger populations was computationally prohibitive). Error bars show SD over 1000 populations with randomly distributed phase and/or position shifts. Horizontal lines depict the upper limit on information determined by a population with uniformly spaced units.}
  \label{fig:c1f1}
\end{figure}


To test the idea that V1 neurons are optimised to extract binocular information, we developed a model system shaped by exposure to natural images. We implemented a binocular neural network (BNN, Fig. \ref{fig:c1f2}A) consisting of a bank of linear filters followed by a rectifying non-linearity. These `simple units' were then pooled and read out by an output layer (`complex units'). The binocular receptive fields and readout weights were optimised by supervised training on a near {\it vs}. far depth discrimination task using patches from natural images (Supplementary Figure \ref{fig:c1fs1}). Thereafter, the BNN classified depth in novel images with high accuracy ({\it A}=99.23\%). 

\begin{figure}[!h]
  \centering
  \includegraphics{chapter1/chapter1-figs/Fig2.pdf}
  \caption[The Binocular Neural Network.]{The Binocular Neural Network (BNN). ({\bf A}) Network architecture: left and right images are filtered by simple units (28 binocular convolutional kernels), linearly rectified, and then readout by two output units. The form of the (i) receptive fields and (ii) readout weights was determined through back-propagation optimisation on {\it near vs. far} depth discrimination using patches from stereoscopic natural images \cite{Li:2014ik}. The network learnt 21,254 parameters through exposure to 32,300 image pairs. ({\bf B}) The BNN's optimised receptive fields resembled Gabor functions (mean explained variance by fitting Gabors to the 28 binocular receptive fields was $R^2=0.95$, $s.d.=0.049$) and V1 receptive fields \cite{DeAngelis:1991mb} ({\bf C}) Summary of position and phase encoding by the simple units; representative units from (B) highlighted using colour. Note very few units show pure position or phase offsets. See also Supplementary Figure \ref{fig:c1fs1} and Supplementary Figure \ref{fig:c1fs2}.}
  \label{fig:c1f2}
\end{figure}


\subsection{Optimisation with natural images produces units that resemble neurons}

The optimised structure of the BNN resembled known properties of simple and complex neurons in three main respects. First, simple units' receptive fields were approximated by Gabor functions (Fig. \ref{fig:c1f2}B) that exploit hybrid encoding (Fig. \ref{fig:c1f2}C; Supplementary Figure \ref{fig:c1fs2}) \cite{DeAngelis:1991mb, Prince:2002uq, Tsao:2003pi} with physiologically-plausible spatial frequency bandwidths (mean=2.3 octaves). Second, like V1 neurons, the BNN supported excellent decoding of depth in correlated random dot stereogram (cRDS) stimuli (Fig. \ref{fig:c1f3}A) ({\it A}=99.93\%; {\it CI}\textsubscript{95\%}=99.87\%, 99.98\%) that are traditionally used in the laboratory, despite being trained exclusively on natural images. Third, we tested the BNN with anticorrelated stimuli (aRDS) where disparity is depicted such that a dark dot in one eye corresponds to a bright dot in the other (Fig. \ref{fig:c1f3}A). Like V1 complex cells \cite{Ohzawa:1990cq,Cumming:1997ve, Samonds:2013cs}, disparity tuning was inverted and attenuated (Fig. \ref{fig:c1f3}B), causing systematic mispredictions of the stimulus depth ({\it A}=8.83\%; {\it CI}\textsubscript{95\%}=7.62\%, 9.03\%). 

\begin{figure}[!h]
  \centering
  \includegraphics[width=14cm,keepaspectratio]{chapter1/chapter1-figs/Fig3.pdf}
  \caption[ BNN response to correlated and anticorrelated random-dot stereograms.]{ BNN response to correlated and anticorrelated random-dot stereograms. ({\bf A}) Cartoons of correlated (cRDS, green) and anticorrelated (aRDS, pink) dot patterns with red-green anaglyph demonstrations. ({\bf B}) Complex unit's disparity tuning curve for cRDS {\it vs}. aRDS; shaded area shows $CI_{95\%}$. ({\bf C}) Distribution of amplitude ratios for cRDS {\it vs}. aRDS for the BNN (grey histogram; 5000 resamples), and macaque V1 neurons. Amplitude ratios were determined based on Gabor fits (average explained variance, $R^2=0.945$) ({\bf D}) Representation of the weighted readout of the simple units. Units are ordered by their readout weight with {\it far}- preferred units at the top. ({\bf E}) Mean activity for simple units in response to cRDS and aRDS. ({\bf F}) Summary of excitatory (red) and suppressive (blue) drive to the output units for cRDS {\it vs.} aRDS. This represents the sum of the weighted simple unit activity split into the excitatory (positive weights) and suppressive (negative weights) components. Error bars (hardly visible) show $CI_{95\%}$. See also Supplementary Figure \ref{fig:c1fs3}.}
  \label{fig:c1f3}
\end{figure}


V1 complex cell attenuation for aRDS is not explained by the canonical energy model, necessitating extensions that have posited additional non-linear stages \cite{Lippert:2001ur, Haefner:2008jg, Samonds:2013cs, Read:2002kx}. However, the BNN naturally exhibited attenuation: by computing the ratio of responses to aRDS {\it vs}. cRDS, we found striking parallels to V1 neurons \cite{Cumming:1997ve, Samonds:2013cs} (Fig. \ref{fig:c1f3}C). There was a divergence between the two comparison physiological datasets for low amplitude ratios, with our model closer to Samonds et al \cite{Samonds:2013cs}. We speculate that this relates to the disparity selectivity of the sampled neurons: Cumming and Parker \cite{Cumming:1997ve} recorded closer to the fovea where sharper disparity tuning functions might be expected. Accordingly, we observed greater attenuation (i.e., lower amplitude ratios) when the BNN was trained on multiway classifications (e.g., 7 output units, rather than 2) which produced more sharply tuned disparity responses (Supplementary Figure \ref{fig:c1fs3}). Together, these results show that inversion and attenuation for anticorrelation appear in a system optimised to process depth in natural images. 


The traditional account of aRDS is that they simulate `false matches' that the brain discards to solve the correspondence problem \cite{Tanabe:2004mw,Janssen:2003fk}. An alternative possibility, however, is that aRDS responses reflect a computational mechanism for extracting depth. To test this idea, we interrogated the BNN by ordering simple units by their readout weights (Fig. \ref{fig:c1f3}D) and then visualising the activity evoked by different stimulus types (Fig. \ref{fig:c1f3}E). The weighted-readout of simple unit activity defines the overall excitatory and suppressive drive to complex units in the network. We found that presenting aRDS led to a striking increase in the activity of the non-preferred simple units, while the activity of the preferred units was more-or-less unchanged. The consequence of this is that when this activity is readout it causes increased suppression at the preferred disparity (Fig. \ref{fig:c1f3}F). This changed the net drive to the complex unit from excitation to suppression (inversion), while the comparatively smaller difference between the excitatory and suppressive drives for aRDS produced a reduced amplitude (attenuation). Thus, attenuation and inversion can be understood based on changing the balance of excitation and suppression, without necessitating additional processing stages. 


To ensure that these parallels between the BNN and neurophysiology were not incidental, we tested whether he BNN produces outputs that are well-matched to the input stimuli. We used an optimisation procedure that started with random noise input images and iteratively adjusted the images such that the activity of a given complex unit was maximized (Fig. \ref{fig:c1f4}A). Following optimisation, the stimuli that best activated the complex units resembled a contrast edge horizontally translated between the eyes (Fig. \ref{fig:c1f4}B). Thus, the BNN is optimised for the translation of visual features that results from binocular viewing geometry \cite{Wheatstone:1838xf}. Importantly, this is achieved using simple units that respond predominantly to different features in the two eyes (Fig. \ref{fig:c1f2}B), which are traditionally understood as `false' matches (i.e., that do not correspond to the same physical real-world object). In other words, the BNN extracts depth structure without explicitly `solving the correspondence problem'. 

\begin{figure}[!h]
  \centering
  \includegraphics{chapter1/chapter1-figs/Fig4.pdf}
  \caption[Optimal stimuli for the binocular neural network.]{({\bf A}) Computing the optimal stimulus for a complex unit. Starting with random noise inputs, the algorithm computed the gradient of complex unit activity with respect to the input images. It iteratively adjusted the inputs to maximize the complex unit's activity. ({\bf B}) Snapshots of three iterations during optimisation: a consistent On-Off pattern emerges in the left and right eyes, horizontally translated to match the preferred disparity of the unit. ({\bf C}) This pattern remains when `lesioning' the BNN of 25\% of the simple units that use position encoding. ({\bf D}) Removing highly-weighted hybrid units leads to input images that are unrealistic.}
  \label{fig:c1f4}
\end{figure}


To strengthen this conclusion, we examined the consequences of `lesioning' the BNN by removing 25\% of its units. In particular, we removed units with near-zero phase disparities (i.e., the seven units within $\pm \frac{\pi}{4}$ of zero phase offset) that are therefore best described as position disparity units that sense similar features in the two eyes. First, we considered decoding performance and found no effect on accuracy ({\it A\textsubscript{Pos}}=99.97\%, {\it CI}\textsubscript{95\%}=99.92\%,100\%; {\it p}=.76; Supplementary Figure \ref{fig:c1fs2}D). To situate this null result in the context of arbitrarily removing a quarter of the units, we also computed decoding performance when we randomly removed seven simple units. In this case, decoding performance dropped considerably (Supplementary Figure \ref{fig:c1fs2}D), and there was only 3.8\% chance of obtaining a value greater than {\it A\textsubscript{Pos}}. This suggests that the pure position units contribute little to registering the binocular information by the BNN: they are given little weight so removing them has little effect relative to removing phase or hybrid units. Second, we computed the optimal stimulus for the lesioned BNN (Fig. \ref{fig:c1f4}C), finding little change relative to the uncompromised network. This null result was not inevitable: removing other simple units resulted in unrealistic images (Fig. \ref{fig:c1f4}D). Together, this indicates that the BNN does not critically depend on binocularly-matched features.

But how does the BNN extract depth using mismatches, and why should it respond to anticorrelated features? Under the traditional approach, this is a puzzle: a physical object at a given depth would not elicit a bright feature in one eye and a dark feature in the other. However, as we have seen, anticorrelation at the preferred disparity of a complex cell leads to strong suppression. This suggests a role for \emph {proscription}: by sensing \emph {dissimilar} features the brain extracts valuable information about unlikely interpretations.

\subsubsection*{\textit{The BNN accounts for unexplained perceptual results}}

 If proscription has a perceptual correlate, then stereopsis should be affected by the availability of dissimilar features in the scene, an idea we now explore. First, seeing depth should be easier when there is more potential for anticorrelation at the \emph {incorrect} disparity. This logic naturally explains a long-standing puzzle from the psychophysical literature \cite{Harris:1995va, Read:2011im} that demonstrated better judgments for stimuli comprising dark and bright dots (mixed polarity) compared to only dark or only bright dots (single polarity) (Fig. \ref{fig:c1f5}A). This result is difficult to accommodate within the Disparity Energy Model because correlation is largely unaffected by differences in the mean or amplitude of the input signals \cite{Read:2011im}.

\begin{figure}[!h]
  \centering
  \includegraphics{chapter1/chapter1-figs/Fig5.pdf}
  \caption[The BNN mirrors properties of human stereopsis.]{ The BNN mirrors properties of human stereopsis. ({\bf A}) Mixed vs. single polarity stereograms. Single polarity stereograms were either all dark, or all bright. The task was to discriminate the step arrangement of the stereogram. Anaglyphs designed for red filter over right eye. ({\bf B}) Proportion of correct choices of the model after 1000 trials. ({\bf C}) Efficiency ratio for mixed {\it vs}. single stimuli measured psychophysically \cite{Harris:1995va} and for the BNN. (Note: the BNN was optimised on natural images, {\it not} random dot stereograms) ({\bf D}) Difference between mixed and single stimuli in terms of the excitatory {\it vs}. suppressive drive to the non-preferred output unit. Error bars $CI_{95\%}$. See also Supplementary Figure \ref{fig:c1fs4}.}
  \label{fig:c1f5}
\end{figure}

 We assessed the BNN's performance on mixed {\it vs}. single polarity stereograms (Fig. \ref{fig:c1f5}B), finding a benefit for mixed stimuli that was very closely matched to published psychophysical data \cite{Harris:1995va, Read:2011im} (Fig. \ref{fig:c1f5}C). What causes this improvement? As reviewed above, the network depends on the activity of the simple units moderated by readout weights. Presenting mixed {\it vs}. single polarity stimuli increases the simple unit activity, in turn changing the excitatory and suppressive drives to complex units. We found that mixed stimuli produce greater excitation for the preferred output unit and increased suppression to the non-preferred unit (Fig. \ref{fig:c1f5}D). 

We carried out a number of controls to ensure that the BNN's performance was not artefactual. In particular, contrasting mixed {\it vs}. single polarity stereograms is complicated by low-level stimulus changes (e.g., overall luminance, or stimulus intensity range) that could act as covariates which underlie performance \cite{Read:2011im}. We directly manipulated covariate properties (Supplementary Figure \ref{fig:c1fs4}), finding that the benefit for mixed stimuli persisted in all cases. We also tested the specificity of this result to the BNN's non-linearity \cite{Read:2011im}. Changing the nonlinearity to an unrectified squaring operation did not change the result (Supplementary Figure \ref{fig:c1fs4}). These controls indicate that the improvement for mixed stimuli generalises over perturbations of the stimuli and network architecture. These results suggest that performance improves for the mixed stimuli because of the opportunity to gain stronger evidence for the true disparity in conjunction with using mismatched features (i.e., dark-to-bright correspondences) as evidence against the incorrect disparity (i.e., proscription). This could be implemented {\it in vivo} using suppressive inputs to V1 neurons \cite{Tanabe:2011pt}.

A second line of evidence in favour of proscription comes from considering situations regarded as too difficult for accounts of stereopsis based on peak correlation. Under natural viewing, certain features are visible to one eye but not the other (Fig. \ref{fig:c1f6}A). The brain exploits such unpaired elements, `Da Vinci' stereopsis, to support depth perception \cite{Gillam:1988lo, Nakayama:1990fc}. However, these stimuli pose a severe challenge to traditional stereo-algorithms because there are no matching features \cite{Anderson:1994tp}. We tested the BNN on a stimulus with unpaired features around a zero-disparity target (Fig. \ref{fig:c1f6}B). Because the target was not displaced in depth, there are no binocular corresponding features to compute the depth relationship. However, the BNN predicted the ordinal depth structure experienced by observers for the edge regions (Fig. \ref{fig:c1f6}B), and this result generalised to stimuli with different luminance configurations (Supplementary Figure \ref{fig:c1fs5}). The BNN thus extracts critical signals that may provide the foundation for a full perceptual interpretation when used in conjunction with processes such as figure-ground segmentation at further stages of visual processing \cite{Ban:2015cr, Tsirlin2014}.

\begin{figure}[!h]
  \centering
  \includegraphics{chapter1/chapter1-figs/Fig6.pdf}
  \caption[Ordinal depth prediction with ill-defined or ambiguous disparities.]{Ordinal depth prediction with ill-defined or ambiguous disparities. ({\bf A}) Illustration of occlusion around the edges of objects. ({\bf B}) `Da Vinci' stereopsis. {\it Left}: Illustration of half-occlusions (black flanks) produced by viewing geometry; {\it Centre}: `Da Vinci' stereograms for cross-eyed fusion; {\it Right}: depth map from the BNN. ({\bf C}) Wallpaper illusion. {\it Top}: Ambiguous pattern. The vertical stripes can be matched by a nasal or temporal shift, making both {\it near} and {\it far} global matches valid. Cross-eyed fusion allows the reader to experience alternation. The BNN does not detect a clear depth. {\it Bottom}: Biasing perception by changing background luminance leads to a concomitant shift in the BNN's interpretation. ({\bf D}) The net drive between excitation and suppression that underlies the shift in prediction, contrasting the ambiguous case and disambiguated cases. Note: for all these examples it is clear that the BNN has not `reproduced' the percept: rather the network provides key signals that may provide the foundations for typical percepts. See also Supplementary Figure \ref{fig:c1fs5}. }
  \label{fig:c1f6}
\end{figure}

Finally, we tested the BNN on the classic `wallpaper illusion' \cite{Brewster:1844jy}, in which periodic patterns yield ambiguous depth percepts. When disparity matches were ambiguous, the disparity-sign map did not identify a clear depth edge (Fig. \ref{fig:c1f6}C). However, by manipulating the background luminance to bias matching \cite{Anderson:1994fk}, we found that the BNN predicted the perceptual interpretation of the stereograms in the edge regions. This was achieved by changing the net excitatory-suppressive drive at the half-occluded regions, where disambiguation occurs (Fig. \ref{fig:c1f6}D). This is compatible with early processing of half-occluded edge regions in V1, providing an initial basis for subsequent depth interpolation supported by extrastriate cortex \cite{Mckee:2007da} or via recurrent connectivity within V1.

Together, these results indicate that, without being trained on such displays, the BNN's combination of detection and proscription provides a natural foundation for typical percepts. The simple units of the BNN exploit receptive fields that capture a continuum of similarities and differences between the binocular images, contrasting with the standard approach to binocular vision that emphasised the importance of correct matches. While individual units in the BNN are not specialised to identify the same feature in the two images, the aggregate readout activity classifies depth with high accuracy and complex units respond best to physically-realistic displacements of a single object.

\subsubsection*{Detection and proscription combine to facilitate sensory estimation}

We have seen that the BNN generalises well from its training set and accounts for both neurophysiological and perceptual phenomena. However, the network's multiple parameters may act as a barrier to a detailed understanding of its operation. We therefore sought to explain the BNN's behaviour in theoretical terms by deriving a low-parameter closed-form model that captures its key characteristics. Our starting point was to observe that a low-dimensional rule relates the BNN's simple units and their readout: weights are proportional to the cross-correlogram between the (left and right) receptive fields ({\it R}=0.89; {\it p}$<$.001) (Supplementary Figure \ref{fig:c1fs6}}). 


The key intuition behind this relationship is that receptive fields capturing a positive correlation at disparity $\delta_{i}$ (i.e. the lag of the cross-correlogram) should be read out by a complex unit with preferred disparity $\delta_{i}$ using a positive (i.e. excitatory) weight. Conversely, if the simple unit captures a negative correlation at disparity $\delta_{i}$, the complex unit should read out its activity using a negative (suppressive) weight. In other words, the same simple units can be read out with detection or proscription to provide a population-based estimate of the depth of the viewed scene.


We show formally (Methods) that using weights determined by the cross-correlogram of the left and right receptive fields is optimal under reasonable assumptions, and propose a Binocular Likelihood Model captured by a simple equation,
\[
\log L(\delta) = \sum_{i=1}^N r_i (W_L \star W_R)_i [\delta].
\]
This relationship states that the activity of a complex unit that prefers a given disparity $\delta$ (expressed as a log likelihood, $L(\delta)$), is given by a weighted sum of simple unit activity, $r_i$. The weights correspond to the cross-correlation, $(W_L \star W_R)_i$, between the left and right receptive fields of simple unit $i$ at disparity $\delta$ (Fig. \ref{fig:c1f7}). To demonstrate the model, we implemented an instantiation that produces disparity tuning curves for correlated and anticorrelated RDS that closely resemble V1 complex cells (Supplementary Figure \ref{fig:c1fs7}). This instantiation included a single spatial frequency channel, so the model does not require pooling across spatial scales to exhibit attenuation for aRDS. The model's key parameters are simply the receptive fields of the input units. This suggests that a fixed, stimulus-independent architecture explains key binocular phenomena, possibly without supervised learning.  


\begin{figure}[!h]
  \centering
  \includegraphics{chapter1/chapter1-figs/Fig7.pdf}
  \caption[Binocular Likelihood Model.]{Binocular Likelihood Model. Input images are processed by a population of simple units that perform linear filtering followed by nonlinear rectification. The activity of a given simple unit ($r_i$) is readout by multiple complex units. A simple unit's readout weights vary over complex units, where the readout weight is defined by the cross-correlation of the simple unit's left and right receptive fields. The activity of the population of complex cells encodes the likelihood function for stimulus disparity. See also Supplementary Figure \ref{fig:c1fs6} and Supplementary Figure \ref{fig:c1fs7}.}
  \label{fig:c1f7}
\end{figure}


\section{Discussion}

Traditional understanding of stereopsis at the computational-, neural- and perceptual- levels has focused on the idea that peak correlation should be used to identify similar features and discard false matches. The logic underlying this approach is based on inverting the geometry that maps objects at different locations in space onto different portions of the two retinae. However, here we show that envisaging neurons as units that match up the features of objects in the world fails to account for known properties of neurons, and overemphasises the role of similarity in a system whose fundamental benefit lies in differences between the images sensed by the two eyes. 

We demonstrate that V1 neurons have properties ideally suited to extract binocular information, rather than simply searching for matching features. We formalise a Binocular Likelihood Model that provides a unifying account for previously puzzling properties of V1 neurons as well as perceptual phenomena that challenge the standard approach. This model highlights the interplay between feature detection and proscription for perceptual inference. This mix of evidence for and against likely interpretations may represent a general strategy for perceptual integration both within and between sensory modalities.

\subsubsection*{Understanding the functional role of sensory neurons}

Understanding the coding strategies of sensory neurons represents a longstanding challenge. A historically pervasive idea is that sensory neurons act as `feature detectors', signalling evidence for the occurrence of a particular feature in the environment \cite{Barlow:1953ep, Lettvin:1959gs}. For instance, orientation-selective neurons could indicate the presence of a particular tilted edge in a visual display \cite{HUBEL:1959tz}. It has long been recognised that natural images shape this selectivity \cite{Barlow:1961fe, Simoncelli:2001dn}, with neural responses optimised for efficient representation of the statistical regularities of the environment \cite{Karklin:2009hl, Li:1994jm}. 

Here we take the approach of quantifying the information conveyed by early sensory neurons that are sensitive to binocular disparity using information analysis, and then by implementing a neural network optimised by exposure to natural images. This provides insight into the functional purposes of disparity representations at the neural and perceptual levels. Our findings on the utility of hybrid receptive fields for disparity encoding are consistent with work that used dimensionality reduction to estimate the optimal disparity filters \cite{Burge:2014qj}. In particular, our observation that hybrid units capture greater Shannon information is consistent with the idea that hybrid encoding maximises disparity estimation accuracy. Moreover, hybrid receptive fields are suggested to minimise the statistical redundancy of binocular responses \cite{Okajima:2004cy,Hunter:2015kx, Hunter:2016gb}, suggesting an additional factor driving the brain's use of hybrid units.

\subsubsection*{Understanding the encoding properties of the BNN}

Previously it was suggested that phase encoding is used to sense `impossible' stimuli. In particular, Read and Cumming \cite{Read:2007nx} made an important proposal that key depth information is conveyed by positional disparities, with phase disparity used to select between alternative positional signals in cases of ambiguity. They suggested this would filter out `false' matches, and thereby solve the correspondence problem. In contrast, our model is based on the combination of feature detection and proscription, rather than using mismatches as a veto. As we have shown, extracting depth structure can be achieved without units that register pure positional disparities: only 3/28 simple units responded to position offsets without phase offsets (Fig. \ref{fig:c1f2}B) and removing units with small phase offsets had little consequence on the performance of the network (Fig. \ref{fig:c1f4}C). 

More generally, it is important to ask why the BNN, optimised by natural images, uses hybrid encoding for its simple units. The traditional exposition of binocular vision starts from the convenient geometry of how a small number of isolated points in the world project into the retinal images sensed by the two eyes. Models of binocular vision are typically built upon the logic of inverting this mapping based on establishing the `correct' matches. However, the BNN suggests that the diet of early visual neurons consists almost entirely of mismatched features: the one `true' set of correspondences between the two eyes is engulfed by a preponderance of mismatches. 

When interpreting the properties of the BNN it is important to recall that the network learnt the relationship between specific inputs (i.e., one natural image set) and the optimisation objective (i.e., a particular discrimination task). Systematically changing either would change the learnt model. Nevertheless, the BNN generalised to a different stimulus set (random dot patterns) and had properties mirroring neurophysiology. It is interesting that the BNN's receptive fields are vertically-oriented. While this makes sense when capturing horizontal disparities, real V1 binocular neurons have varied orientation tuning preferences \cite{DeAngelis:1991mb}. This difference may relate to the fact that the BNN is constrained to optimise one task (disparity discrimination) while V1 neurons are required to support many. It will be interesting to test how defining models for multiple objectives (e.g., estimating the orientation of features tilted in depth) affects encoding properties. For instance, future work might test whether units become specialised for particular functions {\it vs}. develop joint-encoding characteristics. This might most straightforwardly be applied to proscriptive processing for motion estimation (given the strong computational similarities between disparity and motion \cite{Anzai:2001wi}), but may also extend to other feature dimensions.

\subsubsection*{Relation to the disparity energy model}

The disparity energy model \cite{Ohzawa:1990cq, Fleet:1996tq, Qian:1997bu} has long provided the foundation for understanding binocular vision. While modifications have been proposed to accommodate a number of electrophysiological observations \cite{Read:2002kx,Haefner:2008jg,Samonds:2013cs}, the basic architecture has remained unchanged. Moreover, the link between the implementation and the computational goal of estimating depth has been left obscure.

Here we developed an approach that exploits the same computational building blocks as the traditional model (i.e., linear filters for binocular summation followed by rectification). However, the BLM uses a weighted readout scheme, in which activity can be combined via excitatory or suppressive weights onto a population of complex cells. The main deviations from the traditional model are 1) the existence of multiple simple cell-like neurons, as opposed to the quadrature pairs originally proposed, 2) the incorporation of variable weights that can be suppressive, and 3) the complex unit's use of responses from simple units that do not have the same preferred disparity (because simple units convey information about multiple disparities). These characteristics are not part of the classical energy model, but strongly align with modifications suggested in light of neurophysiological evidence \cite{Haefner:2008jg, Sasaki:2010pi, Tanabe:2011pt, Tanabe:2014ud, Baba:2015ij}. As we have shown, by using a model optimised to estimate depth, readout weights can be derived directly from the model's encoding properties. The fact that doing this reproduces properties of simple and complex cells measured {\it in vivo} suggests that the visual system has been optimized by similar constraints. 

The role we demonstrate for proscription is consistent with evidence that binocular V1 neurons are modulated by excitatory and suppressive components \cite{Tanabe:2011pt}. That suppression lags behind excitation by $\sim$7 ms \cite{Tanabe:2014ud} suggests that it is initiated at very early stages of processing. In particular, the proscriptive registration of dissimilarities could drive suppression of unlikely depths via inhibitory interneurons. The necessity of an additional synapse (via interneurons) would impose a small temporal delay, but this delay is less than would be expected for extra-striate feedback. The BLM suggests that the properties of suppressive inputs shape the inversion and attenuation of complex cell tuning curves for aRDS. Where suppressive input is strong, we expect a clear inversion of the tuning curve, but little attenuation. Conversely, where suppressive input is weak, such that excitation and suppression are nearly balanced, the tuning curve would be severely attenuated. In this case, the close balance between excitatory and suppressive inputs means that highly attenuated cells take longer to cross their firing threshold. This is consistent evidence from barn owls that longer onset latencies are associated with high attenuation \cite{Nieder:2001jl}. 

Finally, the BLM predicts that anticorrelation masks the registration of a correlated disparity signal. Previous work pitted cRDS against aRDS to produce zero net correlation in the display. Participants can judge depth in such displays, leading to the suggestion of an additional mechanism separate from correlation \cite{Doi:2011ku}. In contrast, the BLM posits a single mechanism, and exploits anticorrelation to facilitate the interpretation of depth. We predict that the masking effects of anticorrelation are tuned (i.e., anticorrelated disparities are more suppressed than others) and that spatial limits on masking from anticorrelation are set by V1 complex cell receptive fields.

\subsubsection*{Relation to binocular rivalry}

Our mechanistic account of the early stages of binocular vision suggests a natural link to work on binocular rivalry. Traditionally, the study of rivalry and stereopsis have been separate \cite{Blake:2011bb, Blake:2012wr}, although recent work suggested computational links between them \cite{Muryy:2014hk}. Here we show that proscription is likely to be a key constituent of normal disparity processing. This suggests that stereopsis and rivalry sit along a spectrum of binocular responses mediated by inhibition. This is compatible with work on the perception of visual appearance \cite{Muryy:2016km} and suggests a link to GABA-mediated inhibition related to binocular rivalry. For instance, there is a strong association between human V1 GABA concentration (quantified by Magnetic Resonance Spectroscopy) and monocular percept duration \cite{vanLoon:2013da}. Further, temporary monocular deprivation leads to reduced V1 GABA \cite{Lunghi:2015fc}. Therefore, it seems plausible that inhibitory mechanisms in V1 are related to processing binocular incongruence. It will be interesting to test how the mechanisms we propose are implemented physiologically, and whether these support a unifying axis between rivalry and stereopsis.

\subsubsection*{Relation to cue integration and multisensory processing}


Finally, it is worth noting that neuronal tuning to properties that appear inconsistent with the physical structure of the world are not limited to binocular disparity. In particular, neurons can be tuned to the same or opposite features for different visual cues and/or between sensory modalities \cite{Nadler:2008ha, Kim:2014ic, Morgan:2008fh}. For instance, certain neurons in macaque area MSTd respond maximally to the same direction of motion when specified either by visual- or by vestibular- cues (`congruent'); while others (`incongruent'), have opposite direction preferences between modalities \cite{Morgan:2008fh}. As with the discussion of phase disparity, `incongruent' neurons are puzzling because they respond best to stimulation that could not be caused by a single physical object.  

 The inference framework we provide for binocular vision suggests an important role for neurons that encode proscriptive features. We hypothesise that a similar mechanism is used when combining different cues (e.g., disparity and texture) or sensory modalities (e.g., vision and touch). Specifically, neurons form a continuum of responses (ranging from `congruent' to `incongruent') analogous to `hybrid' disparity encoding. These encoding neurons can be read out by a population of units that integrate signals from different cues. This can broadly be conceptualised as a type of causal inference based on explaining away \cite {Wellman:1993el} and links to suggestions about providing a mechanism for discounting irrelevant properties of viewed stimuli \cite{Kim:2016hd}.

\subsubsection*{Conclusion}

Early sensory neurons are broadly understood as optimised to capture the physical properties of the surrounding environment. Within this context, neural tuning to elements that do not relate to physical objects represents a significant puzzle. Using an optimal information framework, we demonstrate the importance of proscription: neural responses that provide evidence against interpretations incompatible with the physical causes of sensations. We demonstrate the role of these `what not' responses in a neural network optimised to extract depth in natural images. We show that combining detection with proscription provides a unified account of key physiological and perceptual observations in 3D vision that are unexplained by traditional approaches. We capture the encoding and readout mechanisms in simple analytical form, and propose that marrying detection with proscription provides an effective coding strategy for sensory estimation.

\section{Methods}

\subsection*{Information theoretic analysis}

\subsubsection*{Individual simple units}
We sought to formalise the idea that information encoded in the responses of binocular simple units is not restricted to the preferred disparity. To do so, we computed the Shannon information $I$ between broadband stimuli $s$ with varying disparity $\delta$ and simple unit responses $R$,

\begin{equation}
  I(R, s_\delta) = \sum_i p(r_i|s_\delta) \log \frac{p(r_i|s_\delta)}{p(r_i)},
  \label{eq:ShannonInformation}
\end{equation}
 
where $r_i$ denotes the firing rate of the simple unit. The resulting information indicates how well a particular disparity is encoded in the response of the simple unit. In this demonstration, the receptive fields were parameterized as two-dimensional $(x,y)$, vertically oriented Gabor functions,

\begin{equation}
  W(x,y) = e^{((x-x_0)^2 + y^2)/2\sigma^2} \cos (2 \pi f (x-x_0) + \phi),
\end{equation}

where $\sigma$ denotes the Gaussian envelope width, $x_0$ denotes the position, $f$ the spatial frequency, and $\phi$ denotes the phase of the receptive field. To define the disparity encoded by the simple unit, we varied the phase and/or position, and kept the remaining parameters constant. Varying the position parameter introduces a simple translation in the receptive field, while varying the phase causes a change in the internal structure of the receptive field. 

We computed the information carried by a simple unit with preferred disparity of 4 pixels defined by a either a position shift or a phase shift. For this simulation, the receptive field envelope, $\sigma$, was set to 5 pixels and the frequency, $f$, was set to 0.05 cycles/pixel. The stimulus set consisted of 100,000 uniform random dot images with disparities between $-$20 and 20 pixels. For both encoding mechanisms, we observed that individual simple units convey information about non-preferred disparities (Fig. \ref{fig:c1f1}C). This highlights that the activity of simple units selective for a particular disparity could contribute to the activity of complex units tuned to different disparities.

\subsubsection*{Population of simple units}

In the previous section we examined information at the single unit level. Next, we demonstrate how much information is encoded across a small population of simple units ($N=5$) with position, phase and hybrid disparity encoding. We used a small number of units for computational convenience, as the amount of memory required to store the full stimulus-response distribution increased exponentially with the number of units (simulating a population of 10 units, for instance, would require a prohibitive 80 gigabytes of RAM memory). An alternative to study information in larger neural populations would be to use other measures such as the linear Fisher Information -- a quantity that is inversely related to discrimination thresholds, and that can be efficiently computed if responses follow a distribution of the exponential family with linear sufficient statistics\cite{Moreno-Bote:2014hy}. However, we chose to use Shannon Information to avoid focusing on discrimination tasks and obviate further assumptions about the response distribution. 

Although we are now working at the level of multiple simple units, equation \ref{eq:ShannonInformation} can still be used --- the difference is that the response is a vector of activities of multiple simple units, so the underlying probability distributions are multidimensional. Because we are not interested in the information about individual stimulus disparities, but rather how well all disparities are encoded, we integrate over the stimulus disparity,
\begin{equation}
  I(\mathbf{R}, \mathbf{S}) = \sum_\delta \sum_i p(\mathbf{r_i}|s_\delta) \log \frac{p(\mathbf{r_i}|s_\delta)}{p(\mathbf{r_i})}.
  \label{eq:ShannonInformationVector}
\end{equation}

We generated populations of simple units with (i) position shifts, (ii) phase shifts, or (iii) a combination of both (hybrid encoding). The Gaussian envelope width, $\sigma$, and the spatial frequency, $f$, were kept constant, and only the position $x_0$ and the phase $\phi$ parameters were allowed to vary. 

We examined information encoded under two schemes. First, we computed the information under the assumption of uniformly spaced simple units. This ensures minimal overlap between the tuning curves of the simple units, and therefore avoids redundancy (i.e. the suboptimal case where two or more units in the population have very similar tuning curves). Next, we examined information without imposing this uniform spacing, and allowed the simple units to assume random tuning profiles. We did this by generating 1,000 populations for which the position and/or phase shifts (according to the encoding mechanisms under evaluation) were randomly drawn from a uniform distribution. This yielded a distribution of information values for each of the mechanisms. As expected, we observed higher information values for the uniformly distributed population (Fig. \ref{fig:c1f1}D, horizontal lines) when compared to random populations (Fig. \ref{fig:c1f1}D, bar graph). In both cases, we found that hybrid populations carried the most information about the disparity imposed in our stimulus set (Fig. \ref{fig:c1f1}D).

\subsection*{Naturalistic binocular images}

We generated naturalistic stereoscopic images using 100 light-field photographs extracted from the Light Field Saliency Database \cite{Li:2014ik}. The dataset comprised images of a variety of indoor and outdoor scenes --- representative stereo pairs are provided in Supplementary Figure \ref{fig:c1fs1} --- and the corresponding depth maps. First, each RGB image (1080-by-1080 pixels) was converted to gray-scale values and down-sampled at the resolution of the corresponding depth map (328-by-328 pixels). Thereafter, we used the information provided by the depth map to render stereo pairs with arbitrary disparity range. From each light-field acquisition, we extracted a series of images focused at different points in depth, and rendered stereoscopic pairs by shifting the pixels of the original image by an amount proportional to the value of the depth map, restricting the maximum shift to 10 pixels. Pixels that were revealed behind occluded regions (by displacing image features in depth) were filled using linear interpolation. To prevent interpolation from affecting the training procedure, we excluded image patches for which more than 5\% of the pixels were interpolated. 

This method produced 200 stereo pairs. From these images we extracted 38,000 different pairs of smaller image patches (30-by-30 pixels). To ensure accurate disparity information, we excluded image patches with low variance of pixel intensity (gray level s.d. threshold = 20). All image patches were then scaled so that pixel intensity values were contained in the interval between --1 and 1, and randomly divided into training and test sets, as described below. 

We did not use standard two frame stereo datasets (e.g. Middlebury datasets) given that these contain a large range of disparities, making it difficult to obtain sufficiently large training sets for a given set of disparity values. We restricted the network to work on a small number of individual disparities for which we could provide training data. Rendering stereo pairs from the corresponding depth map, as described above, allowed us to generate images with arbitrary disparity range, and therefore increase the number of class exemplars available to train the network. Additionally, native two frame stereo datasets are typically composed of a comparatively small number of photographs, which could lead to exploring a narrow portion of the space of natural image statistics. This would affect the properties of the network and the degree to which it could generalize to other stimuli. 

\subsection*{Binocular Neural Network (BNN)}

\subsubsection*{Architecture}

The binocular network was implemented using Theano \cite{2016arXiv160502688T}, a library for efficient optimization and evaluation of mathematical expressions. We used a simple convolutional neural network that comprised (i) an input layer, (ii) a convolutional-pooling layer and (iii) an output logistic regression layer (Fig. \ref{fig:c1f2}A). The input is convolved with a series of kernels to produce one output map per kernel (which we refer to as convolutional maps). The use of convolution means that each kernel is applied at all different locations of the input space. This significantly reduces the number of parameters that need to be learned (i.e., we do not parametrize all possible pair-wise connections between layers) and allows the network to extract a given image feature at all different positions of the image. 

Inputs were image patches (30x30x2 pixels; the last dimension carrying the left and right images) extracted from stereoscopic images. In the convolutional layer, binocular inputs are passed through 28 binocular kernels (19x19x2 pixels) producing 28 output maps (12x12 pixels). This resulted in 4,032 units (28 maps of dimensions 12x12 pixels) forming 2,911,104 connections to the input layer (4,032x19x19x2 pixels). Since this mapping is convolutional, this required that 20,244 parameters were learnt for this layer (28 filters of dimensions 19x19x2 plus 28 bias terms). We chose units with rectified linear activation functions since a rectifying non-linearity is biologically plausible and necessary to model neurophysiological data \cite{Movshon:1978dq}. The activity, $a$, of unit $j$ in the $k^{th}$ convolutional map was given by:
\begin{equation}
  a_j^{(k)}=(w^{(k)}s_j + b_j^{(k)} )_+
\end{equation}

where $w^{(k)}$ is the 19x19x2 dimensional binocular kernel of the $k^{th}$ convolutional map, $s_j$ is the 19x19x2 binocular image captured by the $j^{th}$ unit, $b_j$ is a bias term and $(.)_+$ denotes a linear rectification non-linearity (ReLU). Parameterizing the left and right images separately, the activity $a_j{(k)}$ can be alternatively written as:

\begin{equation}
  a_j^{(k)}=(w^{(Lk)}s_j^L + w^{(Rk)}s_j^R + b_j^{(k)})_+
\end{equation}

where $w^{(Lk)}$ and $w^{(Rk)}$ represent the $k^{th}$ kernels applied to left and right images (i.e. left and right receptive fields), while $s_L^j$ and $s_R^j$ represent the left and right input images captured by the receptive field of unit $j$. 

The convolutional layer was followed by a max-pooling layer that down-sampled each kernel map by a factor of two, producing 28 maps of dimensions 6-by-6 pixels. Finally, a logistic regression layer (1,008 connections; 36 per feature map, resulting in 1,010 parameters including the bias terms) mapped the activities in the pooling layer to two output decision units. The vector of output activities $r$ was obtained by mapping the vector of activities in the pooling layer a via the weight matrix $W$ and adding the bias terms $b$, followed by a $\mathrm{softmax}$ operation:
\begin{equation}
  r=\mathrm{softmax}(Wa+b)
\end{equation}

The predicted class was determined as the unit with highest activity. For $N$-way classification, the architecture was identical except for the number of output units of the BNN.

\subsubsection*{Training procedure}

The input stereo pairs were first randomly divided into training- (70\%, 26,600 pairs), validation- (15\%, 5,700 pairs) and test- (15\%, 5,700 pairs) sets. No patches were simultaneously present in the training, validation and test sets. To optimize the BNN, only the training and validation sets were used. We initialized the weights of the convolutional layer as Gabor filters with no differences between the left and right images. Therefore, initialization provided no disparity selectivity. With $x$ and $y$ indexing the coordinates in pixels with respect to the centre of each kernel, the left and right monocular kernels $W^L$ and $W^R$ of the $j^{th}$ unit were initialized as

\begin{equation} 
w_j^L = w_j^R = e^{-(x'^2+y'^2)/(2\sigma^2)} \cosâ¡(2\pi f x' + \phi)
\end{equation}

with $f$=0.1 cycles/pixel, $\sigma$=3 pixel, $\theta$=$\pi/2$ radians, $x'=x \cos (\theta)+y \sin (\theta)$, $y'=-x \sin (\theta) + y \cos (\theta)$, and $\phi$  the phase of the cosine term of each unit, which was equally spaced between $0$ and $\pi$. The bias terms of these units were initialized to zero. During training we did not constrain the filters to any particular morphology, neither did we constrain properties such as spatial frequency selectivity. In the logistic regression layer, the weights and bias terms were all initialized to zero. 

The BNN was trained using mini-batch gradient descent with each batch comprising 100 examples (50 examples of each class). For each batch, we computed the derivative of the loss function with respect to parameters of the network via back-propagation, and adjusted the parameters for the next iteration according to the update rule

\begin{equation}
  w_{i+1}=w_i - \alpha \Bigg \langle \frac{\partial L}{\partial w_{(D_i)}} \Bigg \rangle
\end{equation}

where $\alpha$ is the learning rate, and $ \big \langle \partial L/ \partial w_{(D_i)}\big \rangle$ is the average over the batch $D_i$ of the derivative of the loss function with respect to the $w$, evaluated at $w_i$. The learning rate $\alpha$ was constant and equal to 0.001. 

After evaluating all the batches once --- completing one epoch --- we tested the BNN using the validation image dataset. We repeated this process for a maximum of 1,000 epochs. Initially, the maximum number of iterations allowed without improvement was set to 10,000. To allow exhaustive optimization, this limit was increased by a factor of 2 every time there was an improvement of 0.5\% in performance as tested in the validation set.

\subsubsection*{Evaluation}

We tested the BNN using both natural and synthetic images. For natural images, we tested it using 5,700 held-out patches on the test image dataset (i.e. these exemplars were not used for training or validating the network). For comparison with neurophysiological observations, we also tested the BNN using random-dot stereogram patches. This test set consisted of 6,000 randomly generated stereograms containing a mixture of dark and bright dots on a gray background (dot size = 1 pixel; dot density = 50\%). 

For comparison with psychophysical observations, we also tested the BNN with large random-dot stereograms depicting a step-edge (240-by-240 pixels). The dot size was set to 8 pixels and the dot density was approximately 15\%. No occlusion between the dots was allowed. The step disparity was set to 2 pixels. Disparity noise sampled from a Gaussian distribution (s.d.=8 pixels) was added to increase task difficulty. Stereograms could contain bright dots, dark dots (single polarity cases) or an even mixture of both (mixed polarity case) on a uniform mid-gray background. Bright, dark, and mid-gray pixels corresponded to values of $+$1, $-$1 and 0, respectively. Differences in the response to mixed and single polarity stereograms could be affected by differences in mean luminance or contrast. We sought to rule out such effects by performing control analyses where these properties were matched. In particular, we report the results obtained when the mean luminance (DC) was removed, as differences in DC can have a drastic effect on the population responses \cite{Read:2011im}. Similar results were obtained when single polarity stereograms were scaled to have the same peak-to-trough values (i.e. pixel intensities varied from $-$1 to $+$1, producing a range of 2), and scaled to match the range of the mixed polarity stereograms after we had removed the mean luminance. Supplementary Figure \ref{fig:c1fs4} compares results obtained with different manipulations of the images.

\subsection*{Modelling binocular receptive fields}

The receptive fields of simple units in the BNN were not constrained to develop a particular structure (i.e. Gabor functions) during optimization --- they could in principle develop any kind of morphology. We therefore assessed whether the receptive field structure mirrored that found in simple cells in primary visual cortex. In particular, we set out to test (i) if the receptive fields were well approximated by Gabor functions, and (ii) what kind of encoding mechanism they develop --- i.e. position, phase or hybrid encoding. 

We started by assessing whether the receptive fields were well approximated by Gabor functions. To reduce the number of free-parameters, we examined the horizontal cross-section of the receptive field, and fit a 1-dimensional Gabor function,

\begin{equation}
  W = A \times e^{-(x-x_0)^2/(2 \sigma ^2)} \cosâ¡ (2 \pi f(x-x_0)+\phi).
\end{equation}

We used a two-stage procedure for optimization. First, we ran a coarse grid-search to find a good initial guess for the parameters, whereby the combination of parameters with lowest sum of squared errors was selected. Then, taking the grid-search estimates as initial guesses, we estimated the final parameters using bound constrained minimization. The constrained parameters were the amplitude $(0<A<+\infty)$, the center of the envelope $(min(x)<x_0<max(x))$, the phase $(-\pi<\phi<\pi)$ and the frequency, which was constrained to an interval of $\pm 10\%$ around the peak of the Fourier transform of the receptive field profile. To assess whether disparity was encoded via position and/or phase shifts (Fig. \ref{fig:c1f1}B), we subtracted the position/phase parameters between the left and right receptive fields. The phase parameter was wrapped to $[-\pi,\pi]$. 

To address consistency with neurophysiology, we examined the spatial frequency bandwidth of the receptive fields learnt by our model. We quantified spatial frequency bandwidth using two methods. First, we used a non-parametric approach of computing the spatial frequency tuning curve for each filter, and then determining the corresponding bandwidth (FWHM). We found that the spatial frequency bandwidth values were plausible when compared to the bandwidth of V1 neurons \cite{De-Valois:1982fk} (average bandwidth = 2.32 octaves; values ranged from 1.58 to 3.44 octaves). As a confirmatory procedure, we used a parametric approach based on the standard deviation and the frequency parameters of the Gabor fits. This yielded near-identical results, although 13/56 filters could not be evaluated using this method as they produced $NaN$ estimates. 

\subsection*{Varying the number of simple units and testing the importance of positional disparities}

When defining the architecture of the BNN, we arbitrarily set the number of simple unit types to 28. To ensure that our results hold in a more generalized manner, we additionally trained similar versions of the Binocular Neural Network while varying the number of simple unit types. The remaining parameters of the network were kept constant. After optimization, we found a similar pattern of results: we achieved high classification accuracies (Supplementary Figure \ref{fig:c1fs2}A), and the binocular receptive fields developed a combination of phase and position disparities (Supplementary Figure \ref{fig:c1fs2}B, C). 

Relating simple unit properties (i.e. their receptive fields) to the readout of their activity is a key step in understanding the computation performed by the network. We chose to deploy the network with 28 types of simple units as opposed to the models with fewer units. This was because it provided a richer substrate to determine the relationship between simple units properties and their readout, and allowed us to perform a `lesion' analysis of the network where performance was not uniquely dependent on a very small number of units. With fewer units (e.g. 8), performance when dropping units would have become unstable.


\subsection*{Estimating correlated vs. anticorrelated amplitude ratios}

Complex units in the BNN responded more vigorously to correlated (cRDS) than anticorrelated stereograms (aRDS) (Fig. \ref{fig:c1f3}A), a phenomenon that is observed in disparity selective V1 complex cells \cite{Cumming:1997ve,Samonds:2013cs}. We examined whether the degree of attenuation observed in our network was compatible with electrophysiological data. Attenuation is commonly assessed by modelling tuning curves for aRDS and cRDS, and then evaluating the ratio between the corresponding amplitudes \cite{Cumming:1997ve,Tanabe:2004mw,Nieder:2001jl}. Therefore, we modelled the tuning curves using Gabor functions (similar to those used to model the binocular receptive fields) and computed the ratio between the amplitude parameter for correlated and anticorrelated stimuli. We started by generating disparity tuning curves for each complex unit by computing the activity elicited by correlated or anticorrelated random-dot stereograms (50\% dot density) with disparities ranging from $-$20 to 20 pixels (100 trials per disparity) (Fig. \ref{fig:c1f3}B). To avoid relying on a single fit per complex unit, we used bootstrapping to generate 5,000 resampled tuning curves, and we fit a Gabor to each sample. The average explained variance of the fits to the disparity tuning curves was $R^2 = 0.945$ ($R^2=0.93$ for cRDS and $R^2=0.96$ for aRDS). Based on these parameters, we computed the respective amplitude ratios by dividing the amplitudes for aRDS by the amplitudes for cRDS. We finally arrived at a distribution of amplitude ratios (Fig. \ref{fig:c1f3}C) by pooling the data across complex units.

\subsection*{N-way classification}

In addition to the binary case, we also trained a network to perform $N$-way classification. The only change required to the network was an increase in the number of output complex units. In particular, we optimized a network for 7- and 11-way classification. In these cases, the complex units of the network also display inversion and attenuation for anticorrelated random-dot stereograms, with comparable but more variable amplitude ratios (Supplementary Figure \ref{fig:c1fs3}). We found that the corresponding tuning curves featured abrupt changes in selectivity, and some were not well described by Gabor-like profiles. We note that this is also the case in cortex (i.e., that Gabor functions do not always describe disparity tuning well). However, the abrupt variations in tuning could be alleviated by varying the temperature of the $\mathrm{softmax}$ nonlinearity, or by defining the $N$-way classification problem to operate over a broader disparity space.


\subsection*{Computing optimal stimuli}

To confirm that the model was well tuned to extract physical binocular disparities, we computed input images that could best activate the complex units of our model. The intuition is that we can visualize what inputs are most efficient in driving a given complex unit, and thereafter evaluate whether the input is sensible. The objective function is therefore the activity of a given complex unit, which we want to maximize. Equivalently, for an output unit $j$, we minimized the negative of its input:
\begin{equation}
  L_j = - \big( W_j a + b_j \big) 
  \label{eq:OptLoss}
\end{equation}

where $a$ is the vector of simple unit activities, $W_j$ is the readout weight matrix for the $j^{th}$ complex unit, and $b_j$ is the bias term. The goal is thus to find an input image that minimizes $L_j$ (i.e. maximizes the complex unit activity; Fig. \ref{fig:c1f4}A). We did this via gradient descent: we started with a random noise input image, $x$, computed the gradient of the loss function with respect to the input image, and adjusted the latter according to the update rule:

\begin{equation}
  x_{i+1} = x_i - \alpha\frac{\partial L}{\partial x}
\end{equation}

where $\alpha$ is the step size (empirically set to 1). We limited the number of iterations to 100 as this was enough to ensure that optimization reached a stable image configuration (i.e. the correlation between the stimulus in to consecutive iterations saturated at 1). 

The stimuli that best activated the complex units resembled contrast edges horizontally translated between the eyes, in the direction consistent with the preferred disparity of the complex unit (Fig. \ref{fig:c1f4}B). This is consistent with detecting positional offsets. The structure of the optimal stimuli was very similar across the eyes, indicating that stimuli with non-physical (i.e. phase) disparities are not ideal to activate the BNN's complex units. 


\subsection*{Step-edge depth discrimination and depth-sign maps}

In its original form, the BNN takes a 30-by-30 input image patch and produces a binary output corresponding to the predicted disparity ({\it near} or {\it far}). Once trained, however, convolutional neural networks can be applied to higher dimensional inputs, without requiring any changes in the parameters of convolutional layers. We took advantage of this convenience to test the BNN with larger binocular inputs. The only required modification to the BNN happened in the readout layer, where we applied the mean read-out weight for each simple unit in an element-wise manner. This resulted in two output activity maps --- one for near disparities ({\it near} map), and another one for far disparities ({\it far} map). More formally, the vector of activities in the $j^{th}$ output map was defined as:

\begin{equation}
  a_{out}^{(j)}= \sum_{(k=1)}^{28} a_{conv}^{(k)} \hat{w}_{out}^{(kj)} + b^{(j)}
\end{equation}

where $a_{conv}^{(k)}$ is the vector of activities in the $k^{th}$ convolutional map, $\hat{w}_{out}^{(kj)}$ is the mean readout weight between the $k^{th}$ convolutional map and the $j^{th}$ output unit, and $b^{(j)}$ is the vector of bias terms of the $j^{th}$ output unit. Finally, we combined the two output maps by element-wise subtracting the activities of the {\it near} map from the {\it far} map, so that positive values reflect higher {\it near} activity, while negative values reflect higher {\it far} activity.


\subsection*{Relationship between simple unit selectivity and readout}

The activity of complex units in the network depends on the readout of the activity of the population of simple units. We assessed whether there was a relationship between the receptive fields of simple units and the corresponding readout weights. Take, for instance, the complex unit that responded to \textit{near} stimuli: how does this complex unit combine the activity of the population of simple units? We found that it used readout weights that were proportional to the average interocular receptive field cross-correlation at \textit{near} disparities (Supplementary Figure \ref{fig:c1fs6}, red elements; Pearson's $R=0.90$, $p<10^{-9}$). In the same manner, the readout weights for the \textit{far} complex unit were proportional to the average interocular receptive field cross-correlation at \textit{far} disparities (Supplementary Figure \ref{fig:c1fs6}, blue elements; Pearson's $R=0.89$, $p<10^{-9}$). The readout weight is therefore proportional to the interocular receptive field cross-correlation at the preferred disparity of the complex unit.

\subsection*{Derivation of the Binocular Likelihood Model}
\subsubsection*{Interocular RF cross-correlation and disparity selectivity}

It has been noted elsewhere that computing the cross-correlogram between the left and right receptive fields yields a very good approximation of the disparity tuning curve \cite{Ferster:1981kl,Tsao:2003pi,Read:2003ij}. Below we present a derivation that describes this relationship. We start by considering the response $r$ of binocular simple cells to a given binocular stimulus with disparity $\delta$. The binocular half images (i.e., the images captured by the left and right eyes) are horizontally translated versions of one another. Thus, the stereo pairs presented in a given trial $t$ can be defined as $\{S_t(x), S_t(x+\delta)\}$. As observed experimentally, the response of a binocular simple cell can be well described by linear spatial filtering and rectification, followed by a non-linearity \cite{Ohzawa:1990cq,Anzai:1999uq},

\begin{equation}
r = g \big( [S_t(x) W_L(x) + S_t(x+\delta) W_R(x)]_+ \big),
\end{equation}

where $W_L(x)$ and $W_R(x)$ denote the receptive fields of the simple cell for the left and right eyes, and $g$ is an expansive nonlinearity. It has been shown that this non-linearity is well described by a power law with an exponent of approximately 2, $g(x) = x^2$, for $x > 0$ \cite{Anzai:1999uq}. We assume an unrectified squaring non-linearity for mathematical convenience, however, similar results would be obtained for a rectifying squaring non-linearity \cite{Read:2003ij}. Based on this, we can compute a disparity tuning curve, $f(\delta)$, by averaging the response of the simple cell across a large number of trials $T$, 

\begin{IEEEeqnarray}{rCl}
f(\delta) & = & \frac{1}{T} \sum_{t=1}^T r_t \nonumber \\
& = & \frac{1}{T} \sum_{t=1}^T \Bigg( S_t(x) W_L(x) + S_t(x+\delta) W_R(x) \Bigg)^2 \nonumber \\
& = & \frac{1}{T} \sum_{t=1}^T \Bigg( (S_t(x) W_L(x))^2 + (S_t(x+\delta) W_R(x))^2 \nonumber \\
& & + \ 2 S_t(x) W_L(x) S_t(x+\delta) W_R(x) \Bigg).
\label{expandedEnergy}
\end{IEEEeqnarray}

As many others have noted \cite{Fleet:1996tq,Anzai:1999uq,Read:2002kx,Qian:1997bu}, the first two terms are monocular and do not depend on binocular disparity -- over many trials, these two terms should be a positive constant, $C$, independent of the disparity $\delta$ of the stimulus. The disparity dependent modulation of the tuning curve is captured by the interaction term,
 
\begin{IEEEeqnarray}{rCl}
f(\delta) & = & \frac{1}{T} \sum_{t=1}^T \ 2 S_t(x) W_L(x) S_t(x+\delta) W_R(x) + C.
\end{IEEEeqnarray}

This expression describes the expected response for a simple cell with receptive fields $W_L(x)$ and $W_R(x)$ to stereoscopic pairs that are translated horizontally in relation to one another by a given disparity $\delta$. Under this formulation, the response of the simple cell is proportional to the stimulus unnormalized cross-correlation, $S_t(x)S_t(x+\delta)$, weighted by the product of the left and right receptive fields, $W_L(x)W_R(x)$, known as the binocular interaction field \cite{Anzai:1999uq}. 

However, as we will now show, it is useful to reformulate this expression. Because the stereoscopic pairs are simply translated in relation to the position of the receptive fields, it is equivalent to compute a disparity tuning curve by applying the horizontal shift to the receptive fields, while keeping the stereoscopic images in the same horizontal position ($a(x-\delta)b(x)=a(x)b(x+\delta)$),

\begin{IEEEeqnarray}{rCl}
f(\delta) & = & \frac{1}{T} \sum_{t=1}^T \ 2 S_t(x) W_L(x) S_t(x) W_R(x-\delta) + C \\
& = & \frac{1}{T} \sum_{t=1}^T \ 2 S_t(x)^2 \ W_L(x) W_R(x-\delta) + C.
\label{dtXcorr}
\end{IEEEeqnarray}

Equation \ref{dtXcorr} is convenient because it expresses the disparity tuning curve as a function of the dot product between the left and right receptive fields, translated according to the disparity $\delta$. This is by definition the cross-correlation between the left and right receptive fields $(W_L \star W_R)[\delta]$. Note that $\frac{1}{T} \sum_{t=1}^T S_t(x)^2$ is simply the average energy of the stimulus over $T$ trials, which influences the amplitude of the tuning curve (but not its morphology). Therefore,

\begin{IEEEeqnarray}{rCl}
f(\delta) & = & 2 (W_L \star W_R)[\delta] \ \frac{1}{T} \Bigg( \sum_{t=1}^T S_t(x)^2 \Bigg) + C \\
& = & 2 (W_L \star W_R)[\delta] \ \mathbb{E} \Big( S_t(x)^2 \Big) + C.
\label{dtXcorrEnergy}
\end{IEEEeqnarray}

This formulation provides a mathematically convenient way of expressing tuning for binocular disparity solely based on the receptive fields of simple units. Next, we will take advantage of this convenience to establish a relationship between simple unit properties and their readout by complex units.

\subsubsection*{Optimal readout of simple unit activity by disparity selective complex units}

In the previous section, we showed that the disparity tuning curve of a simple unit can be well approximated by the scaled cross-correlogram between the left and right receptive fields. We also suggested that stimulus contrast energy induces variability in the firing rate of simple units. This high variability makes simple units unsuitable for the detection of depth. By combining the activities of multiple simple units, complex units provide much better estimates of disparity. The classical disparity energy model obviates this problem by combining the outputs of four simple units with the same preferred binocular disparity, but with their receptive field phase in quadrature \cite{Ohzawa:1990cq}. 

We now ask how could we optimally combine the activities of a population of simple units with highly variable firing rates. Here, we consider not only the variability in firing rate statistics, but also extrinsic variability induced by the stimulus. Inspired by previous work on optimal sensory representations \cite{Jazayeri:2006fk}, we tackle this problem from a probabilistic viewpoint. Let us interpret the distribution of activity of a simple cell $i$ given a particular disparity $\delta$ as describing the likelihood of observing the firing rate $r_i$ given the disparity $\delta$. We make the simplifying assumption that the response of a simple unit, affected by intrinsic and extrinsic variability, follows a Gaussian distribution around the mean firing rate value, which is given by the corresponding tuning curve, $f_i(\delta)$. Thus, the likelihood for a given simple cell $i$ is given by

\begin{equation}
  p(r_i | \delta) = \frac{1}{\sqrt{2 \pi \sigma_i}} e^{- \frac{(r_i-f_i(\delta))^2}{2 \sigma_i^2}}.
\end{equation}

This equation expresses the probability of observing a firing rate $r_i$ given a stimulus with disparity $\delta$. Assuming independence across a population of $N$ simple cells, we can now combine these probabilities to obtain a joint likelihood,

\begin{equation}
 L(\delta) = p(\mathbf{r} | \delta) = \prod_{i=1}^N p(r_i| \delta) .
\label{eq:JointLikelihood}
\end{equation}
 
By working in log-space, we can convert the logarithm of the product of likelihoods into a sum of logarithms of the likelihood. This is useful because we can express the computation of the likelihood as sum over the activity of many neurons, which is a biologically plausible operation. Equation \ref{eq:JointLikelihood} thus becomes

\begin{IEEEeqnarray}{rCl}
 \log L(\delta) & = & \sum_{i=1}^N \log p(r_i| \delta) \\
& = & \sum_{i=1}^N \log \Bigg( \frac{1}{\sqrt{2 \pi \sigma_i}} e^{- \frac{(r_i-f_i(\delta))^2}{2 \sigma_i^2}}\Bigg) \\
& = & \sum_{i=1}^N -\frac{(r_i-f_i(\delta))^2}{2 \sigma_i^2} - \log \big(\sqrt{2 \pi \sigma_i}) \\
& = & \sum_{i=1}^N \frac{r_i f_i(\delta)}{\sigma_i^2} - \frac{1}{2} \Bigg(\frac{r_i^2}{\sigma_i^2}-\frac{f_i(\delta)^2}{\sigma_i^2} - \log \big(2 \pi \sigma_i) \Bigg). \\
\label{eq:LogLikelihoodDisp}
\end{IEEEeqnarray}

The second term in equation \ref{eq:LogLikelihoodDisp} can be ignored if we assume that the tuning curves of the population of simple cells cover homogeneously the disparities of interest, and thus $ \sum_{i=1}^N f_i(\delta)^2 = constant $. Therefore, dropping the quantities that do not depend on the disparity $\delta$, the computation of the log-likelihood simplifies to a sum of the products between the observed simple cell firing rates $r_i$, and the corresponding tuning curves, $f_i(\delta)$, 

\begin{IEEEeqnarray}{rCl}
 \log L(\delta) = \sum_{i=1}^N r_i f_i(\delta).
\label{eq:LogLikelihoodDispFinal}
\end{IEEEeqnarray}

While this is a useful formulation (and technically more generalizable), it is more intuitive to relate readout to binocular correlation. As we observered earlier, the cross-correlogram is a good approximation to the disparity tuning curve of individual simple cells. By replacing $f_i(\delta)$ according to equation \ref{dtXcorrEnergy} and dropping the constant term that does not depend on disparity, the log-likelihood can be written as 

\begin{IEEEeqnarray}{rCl}
 \log L(\delta) = \sum_{i=1}^N r_i \ (W_L \star W_R)_i[\delta].
 \label{eq:final}
\end{IEEEeqnarray}

Therefore, a population of complex cells can approximate the log-likelihood over disparity simply by weighting the firing rates of individual simple cells by their interocular receptive field cross-correlation. While this particular solution is specific to the assumption of Gaussian variability, the approach followed here could be applied to other forms of response variability using a suitably transformed version of the cross-correlogram. If one assumes Poisson variability, so as to model intrinsic firing rate variability, then the readout form would be a log-transform of the interocular receptive field cross-correlation. 

It should be noted that this derivation approximates the behaviour of the BNN because Equation \ref{expandedEnergy} used a squaring non-linearity while the BNN used a linear rectification. While this would produce differences in activity, the fundamental response properties are likely to be preserved between this derivation and the BNN. 

Finally, we provide an example of a disparity tuning curve obtained using this simple analytical expression. In this simulation, we used 9 simple unit maps with Gabor receptive fields ($f$=0.0625 cycles/pixel; spatial frequency bandwidth, $b$=1.5 octaves; $\sigma$=6.27 pixels), covering the full combination of three position disparities ($\Delta x_0 = \{-3, 0, 3\}$ pixels) and three phase disparities ($\Delta \phi = \{-\pi, -\pi/3, \pi/3\}$ radians). Apart from the number of simple units, we kept the architecture of the model consistent with the Binocular Neural Network. Therefore, the output layer consisted of two complex units -- one preferring \textit{near}, the other preferring \textit{far} disparities. The readout weights between simple and complex units were defined according to the analytical expression for our model (Equation \ref{eq:final}). This instantiation of the model produced complex units with disparity tuning curves that closely resemble those of complex cells in V1 (Supplementary Figure \ref{fig:c1fs7}A): the tuning curves for correlated and anticorrelated stereograms are well approximated by Gabor functions, and anticorrelated tuning curves are inverted and attenuated in relation to correlated stereograms. 

The simple units in this instantiation of the model shared the same spatial frequency preference. This demonstrates that our model does not rely on spatial frequency pooling to produce attenuation in response to aRDS. The spatial frequency bandwidth of the output complex unit was smaller than that of the corresponding simple units (1.07 octaves), consistent with the findings that pooling activity across space narrows spatial frequency selectivity \cite{Kato:2016fk}. However, our model could also encompass simple units with multiple spatial frequencies, and their activities could be subsequently readout by complex units using the relationship established in equation \ref{eq:final}. In this case, pooling across multiple spatial frequencies would increase the bandwidth of the output complex units, while further reducing the response of the model to spurious disparities \cite{Fleet:1996tq} and sharpening the degree of disparity selectivity \cite{Baba:2015ij,Kato:2016fk}. 

One prediction stemming from our model is that response saturation in \textit{simple cells} could modulate the amplitude ratio of downstream complex cells. In particular, introducing a compressive nonlinearity at the level of \textit{simple cells} --- for instance, to account for sublinear binocular integration \cite{Longordo2013} --- causes the aRDS response to further attenuate relatively to the response to cRDS. We demonstrate this effect in Supplementary Figure \ref{fig:c1fs7}B. An expansive non-linearity at the level of simple cells, on the contrary, would cause the degree of attenuation to decrease.

\subsection*{Quantification and Statistical Analysis}
We used bootstrap resampling and we report the corresponding 95\% confidence intervals unless otherwise noted. Results were pooled across stimuli or units within a model, but not across different instantiations of models. For the results of fitting procedures, we report the proportion of variance explained by the models.

\subsection*{Data and Software Availability}
We performed all analyses in Python (\url{http://python.org}) using standard packages for numeric and scientific computing. The data used for model optimization and implementations of the optimization procedure are available at \url{https://doi.org/10.17863/CAM.8538}.

\clearpage

\section{Supplementary Figures}

\begin{figure}[!h]
  \centering
  \includegraphics{FigS1.png}
  \caption[Exemplars used to train the binocular neural network.]{Examples of images used to train the binocular neural network (BNN). Related to Figure \ref{fig:c1f2}. Images were extracted from the Light Field Saliency Database \cite{Li:2014ik}, available at \url{http://www.eecis.udel.edu/\textasciitilde nianyi/LFSD.htm}. Stereo pairs are rendered for cross fusion.}
  \label{fig:c1fs1}
\end{figure}

\begin{figure}[!h]
  \centering
  \includegraphics[width=14cm,keepaspectratio]{FigS2.png}
  \caption[Varying the number of simple units in the network.]{Varying the number of simple units in the network. Related to Figure \ref{fig:c1f2}. \textbf{(A)} Decoding accuracy for instantiations of the network with different number of simple units. \textbf{(B, C)} Binocular receptive fields developed by the corresponding instantiations, and the respective position and phase disparities. \textbf{(D)} Testing the importance of the positional disparity units for the 28 simple unit BNN. Decoding performance is shown for the full model, the model with the positional units removed (i.e., 25\% of units around zero phase offsets), and the model with a randomly selected removal of 25\% of the non-positional simple units (mean of 1,000 resamples). The limited impact of removing the position disparity units suggest these units do not play a strong role in determining the performance of the BNN.}
  \label{fig:c1fs2}
\end{figure}

\begin{figure}[!h]
  \centering
  \includegraphics[width=14cm,keepaspectratio]{FigS3.png}
  \caption[Responses to correlated and anticorrelated stereograms.]{Comparing responses to correlated and anticorrelated stereograms. Related to Figure \ref{fig:c1f3}. \textbf{(A)} Response attenuation for anticorrelated versus correlated random-dot stereograms for 7- and 11-way classification. Bar graphs depict amplitude ratio (aRDS/cRDS) calculated based on peak-to-peak differences for 2-way, 7-way and 11-way (mean and $CI_{68\%}$ obtained via bootstrapping, 5,000 resamples per output unit). A bias towards values below unity is evident, consistent with the results shown in Figure \ref{fig:c1f3}C. Note that attenuation appears greater for 7- and 11- way classification. This may result from the network developing more sharply tuned units. Figure \ref{fig:c1f3}C indicates a hitherto unappreciated difference between the electrophysiological recordings of Cumming \& Parker \cite{Cumming:1997ve} vs. Samonds et al \cite{Samonds:2013cs} at low attenuation ratios. Cumming \& Parker \cite{Cumming:1997ve} found a bias towards low-amplitude ratios. We speculate that this arose because they sampled closer to the fovea (RFs had eccentricities ranging from 1 to 4 degrees whereas Samonds et al sampled at 4 degrees eccentricity). This difference in sampling strategy may have resulted in recording neurons that were more sharply tuned for disparity, and thus showed greater attenuation for anticorrelated stimuli. \textbf{(B)} Disparity tuning curves of output units for 7-way (top) and 11-way classification (bottom). Inversion and attenuation can be observed in the majority of the units. There is considerable variability in the degree of attenuation across units, consistent with neurophysiological observations.}
  \label{fig:c1fs3}
\end{figure}

\begin{figure}[!h]
  \centering
  \includegraphics{FigS4.png}
  \caption[Controls for performance on mixed and single polarity stimuli.]{Control analyses for performance on mixed \textit{vs.} single polarity stereograms. Related to Figure \ref{fig:c1f5}. We tested the performance of the BNN under several image adjustment conditions: no image adjustment (none); DC correction, in which we subtracted the mean intensity of the input images (dc); scale matching, in which we scaled the images to have the same peak-to-trough range (scaled); and DC correction plus scale matching, in which we removed the mean intensity of the images and scale them to the same peak-to-trough range (both). In the main paper we report results obtained with DC correction, and we re-plot them here to facilitate comparison with the remaining conditions. We ran an additional control in which the rectified-linear nonlinearity was replaced by a (unrectified) squaring nonlinearity \textbf{(A)} Proportion of correct trials under the different image adjustment conditions (1,000 trials; error bars show bootstrapped $CI_{95\%}$, 5,000 resamples). \textbf{(B)} Efficiency ratios for the BNN (1,000 trials; error bars depict $CI_{95\%}$, 5,000 resamples) plotted alongside experimentally measured efficiency ratios in humans (mean $\pm$ 1 s.d.) \cite{Harris:1995va}.} 
  \label{fig:c1fs4}
\end{figure}

\begin{figure}[!h]
  \centering
  \includegraphics{FigS5.png}
  \caption[Half-occlusions and ambiguous stimuli.]{Response of the binocular neural network to half-occluded and wallpaper stimuli. Related to Figure \ref{fig:c1f6}. \textbf{(A)} Response of the BNN to unpaired bright flanks around a dark occluder. Luminance configuration was inverted relatively to Figure \ref{fig:c1f6}B. \textbf{(B)} Response of the BNN to a wallpaper pattern in which stripes are darker than the background. Compare to Figure \ref{fig:c1f6}C, where the pattern is defined by bright and dark stripes on a mid-gray background.}
  \label{fig:c1fs5}
\end{figure}

\begin{figure}[!h]
  \centering
  \includegraphics{FigS6.png}
  \caption[Relationship between receptive field properties and readout weights.]{Relationship between the simple unit receptive fields and readout weights. Related to Figure \ref{fig:c1f7}. Examining the properties of the BNN showed that the simple unit readout weights are proportional to the receptive field interocular correlation at the preferred disparity. Thus, a complex unit with preferred disparity $\delta$ reads the activity of a simple unit with a weight proportional to the correlation between the simple unit's left and right receptive fields at the disparity $\delta$. Red elements: near complex unit; blue elements: far complex unit.}
  \label{fig:c1fs6}
\end{figure}

\begin{figure}[!h]
  \centering
  \includegraphics{FigS7.png}
  \caption[Disparity tuning curves in the Binocular Likelihood Model.]{Disparity tuning curves obtained in a simple instantiation of the Binocular Likelihood Model (BLM). Related to Figure \ref{fig:c1f7}. Tuning curves were computed for correlated (green elements) and anticorrelated (pink elements) stereograms. Solid lines represent Gabor fits. Error bars depict resampled $CI_{95\%}$ (5,000 resamples). \textbf{(A)} Tuning curves for cRDS and aRDS assuming simple units with linear rectification \textbf{(B)} As in \textbf{A}, but assuming simple units with a compressive non-linear activation function (in this case, the square root) - i.e. effectively implementing sublinear binocular integration \cite{Longordo2013}}
  \label{fig:c1fs7}
\end{figure}


% ------------------------------------------------------------------------

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "../thesis"
%%% End: 
